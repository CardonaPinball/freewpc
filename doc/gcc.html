
<h1>GCC for the 6809 Processor</h1>

<p><b>FreeWPC</b> uses a port of the GNU C Compiler (gcc) to the 6809.
This port is not officially part of gcc, and exists "out of tree".
However, I have found that it works pretty well, after making some
modifications to it.

<p>This documentation describes some of the limitations of the C
compiler, how you should be careful when coding performance critical
routines, and some of the changes that I made to it specifically for
this project, which may or may not be of use to others.

<h2>Basic Types</h2>

<p>For performance, we take care to use the smallest data type that will
work.  Wherever possible, we use unsigned 8-bit values (<b>U8</b>).
This maps to the C <b>unsigned char</b> type.  gcc consider plain <b>int</b>
to be signed, 16-bit.  There is only one register that can be used for
this purpose, the D register, so it should not be used unless necessary.

<h2>Argument Passing Conventions</h2>

<p>All function arguments are passed by pushing them onto the stack.
Byte arguments are NOT extended to int when passing them, to minimize
stack usage.  Because of this, you MUST use a function prototype for any
function you call, so that the compiler can verify that the parameter
types match.

<p>I made one change to the gcc core to reduce the amount of stack
space that it will use before popping arguments.  Normally, gcc will
keep arguments on the stack for some time, and then try to pop lots of
the arguments at once, to reduce the number of pop instructions.
Because our kernel only gives each task a very small amount of stack
space, this can lead to stack overflow pretty quickly with the default
values.

<h2>Register Usage</h2>

<h2>Stack Usage</h2>

<h2>Using <i>#pragma section</i></h2>

<h2>Using Inline Assembly</h2>

<h2>References</h2>

<ul>
<li><a href="">GCC Internals Manual</a>
</ul>
